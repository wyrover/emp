{"version":3,"sources":["employee.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"employee.js","sourcesContent":["\"use strict\";\nVue.http.headers.common[\"X-CSRF-TOKEN\"] = document.querySelector(\"#token\").getAttribute(\"value\");\nvar baseURL =  'http://'+window.location.host ;\nvar vm = new Vue({\n  el: \"#employee\",\n  data: {\n    keyword: \"\",\n    sortKey:\"\",\n    reverse:false,\n    records_show:10,\n        pagersCount:5,//显示的pager数量\n        perpage:15,\n        disabled:true,\n        columns:[\n        \"人员姓名\",\"工作岗位\",\"所属单位\",\"所在现场\",\"护照号码\",\"护照期限\",\"签证期限\",\"赴哈时间\",\"更多操作\"\n        ]\n      },\n\n      ready:function(){\n       this.getData();\n     //this.makePagers();\n   },\n\n   methods:{\n\n    buttonState:function(){\n\n      if($(\"#datatable>tbody input:checkbox:checked\").length>0)\n      {\n       this.disabled = false;\n     }else\n     this.disabled = true;\n   },\n        //从API获取相应数据\n        getData: function(page){\n          this.$http.get(baseURL+\"/api/v1/employee?page=\"+page+\"&perpage=\"+this.perpage,function(data){\n            this.$set(\"data\",data[\"data\"]);\n            this.$set(\"total\",data[\"total\"]);\n            this.$set(\"from\",data[\"from\"]);\n            this.$set(\"to\",data[\"to\"]);\n            this.$set(\"perPage\",data[\"per_page\"]);\n            this.$set(\"currentPage\",data[\"current_page\"]);\n            this.$set(\"lastPage\",data[\"last_page\"]);\n          }).success(function(){\n            $(\"#checkAll\").prop(\"checked\",false);\n          }).error(function (status) {\n            $(\"#show-error\").show();\n          });\n        },\n\n        changePerPage:function(param){\n          this.perpage =  param;\n          this.getData();\n        },\n\n        getOption:function(e){\n\n          var checkboxes = $(\"#datatable>tbody input:checkbox:checked\");\n          var ids = [];\n          checkboxes.each(function(){\n            ids.push($(this).val());\n          });\n\n          if (e.target.id == \"delete\"){\n            this.doDelete(ids);\n          }\n\n          else if (e.target.id == \"edit\"){\n            window.location.href=baseURL+'/admin/employee/'+ids+'/edit/';\n          }\n\n          else if (e.target.id == \"create\"){\n            window.location.href=baseURL+'/admin/employee/create/';\n          }\n\n\n        },\n\n        doDelete:function(ids){\n          this.$http.delete(baseURL+'/api/v1/employee/'+ids)\n          .success(function(){\n            this.getData();\n            this.disabled = true;\n            $(\"#modal\").modal(\"hide\");\n          });\n        },\n\n\n        checkAll:function(e){\n          $('input:checkbox').prop('checked', e.target.checked);\n          this.buttonState();\n        },\n\n        //页面传递过来v-on索引值($index),然后进行判断\n        sortBy:function(index){\n            var items = Object.keys(this.data[0]);//获取json对象各个节点(id,name,job...)\n            var onKey = Object.keys(items)[index]; //获取到当前点击的表头名的索引值\n            if(items[index] == \"name\")\n            {\n              this.sortKey = \"pinyin\";\n            }\n            else{\n                this.sortKey = items[onKey];//当前排序值等于表头点击的那个值\n              }\n\n            this.reverse = (index == onKey) ? !this.reverse : false; //如果初始的sortKey==onKey,反转,否则返回false不响应\n\n          },\n\n          goSearch:function(){\n           this.perpage = 'all';\n           this.getData('all');\n         },\n         clearInput:function(){\n           this.$$.input.value = '';\n         }\n       },\n\n       computed:{\n        pagers:{\n          get:function(){\n            var pagers = [];\n              var current = this.$data[\"currentPage\"]; //从API中获取当前页码\n              var max = this.$data[\"lastPage\"];\n              var limited = current + this.pagersCount;\n              var sidebar = Math.round((parseInt(this.pagersCount) -1) /2);  //为把当前页面放到页码指示器的中间，获取两侧数量\n              if(current - sidebar <1){\n                if( current + sidebar >= max){\n                  for(var i = 1; i <= max ; i++){\n                    pagers.push(i);\n                  };\n                }\n                else{\n                  for(var i = 1; i < limited ; i++){\n                    pagers.push(i);\n                  };\n                }\n              }\n\n\n              else if ( current + sidebar > max ){\n               if(max - this.pagersCount > 0){\n                 for(var i = max - this.pagersCount; i < max+1; i++){\n                   pagers.push(i);\n                 }\n               }\n               else{\n                 for(var i = 1; i <= current; i++){\n                   pagers.push(i);\n                 }\n               }\n             }\n\n             else{\n              for(var i = current; i < limited ; i++){\n                var j = i- sidebar;\n                pagers.push(j);\n                j++;\n              };\n            }\n\n\n            return pagers;\n          }\n        }\n      }\n\n\n    });\n"],"sourceRoot":"/source/"}