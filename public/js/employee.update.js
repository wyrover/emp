"use strict";Vue.http.headers.common["X-CSRF-TOKEN"]=document.querySelector("#token").getAttribute("value");var chart,api="http://"+window.location.host+"/api/v1/employee",pinyin_api="http://"+window.location.host+"/api/v1/pinyin",re=/[0-9]+/,id=window.location.href.match(re),my_api=api+"/"+id,vm=new Vue({el:"#app",data:{data:[],items:{},selected_company:1,selected_job:1,selected_office:1,selected_visa:1,selected_handle:1,pinyin:"",memo:"",myData:[]},ready:function(){this.fetchAPI(),this.fetchMe()},methods:{fetchAPI:function(){this.$http.get(api+"/create",function(e){this.$set("data",e)})},fetchMe:function(){this.$http.get(my_api,function(e){this.$set("name",e.name),this.$set("pinyin",e.pinyin),this.$set("selected_company",e.company.id),this.$set("selected_job",e.position.id),this.$set("selected_handle",e.visa_handle.id),this.$set("selected_visa",e.visa_type.id),this.$set("passport",e.passport),this.$set("reached_at",e.reached_at),this.$set("passport_date",e.passport_date),this.$set("passport_deadline",e.passport_deadline),this.$set("visa_deadline",e.visa_deadline),this.$set("land_deadline",e.land_deadline)}).success(function(){removeLoading()})},submit:function(){this.fetchForm(),this.validate()||this.$http.put(my_api,this.items).success(function(){removeLoading(),window.location.href=window.location.origin+"/employee/show/"+id})},fetchForm:function(){var e=$("#name").val(),t=$("#company option:selected").val(),i=$("#position option:selected").val(),a=$("#office option:selected").val(),s=$("#reached_at").val(),n=$("#passport").val(),o=$("#passport_date").val(),d=$("#passport_deadline").val(),p=$("#visa_type_id").val(),c=$("#visa_deadline").val(),h=$("#land_deadline").val(),l=$("#visa_handle_id").val(),r=$("#pinyin").val(),_=$("#memo").val();this.items={name:e,company_id:t,position_id:i,office_id:a,reached_at:s,passport:n,passport_date:o,passport_deadline:d,visa_type_id:p,visa_deadline:c,land_deadline:h,visa_handle_id:l,pinyin:r,memo:_}},validate:function(){var e=!1;return $("#form input").each(function(){""==$(this).val()?($(this).closest(".form-group").addClass("has-error"),e=!0):$(this).closest(".form-group").removeClass("has-error")}),e},touchPinyin:function(){var e={name:$("#name").val()};""==e?this.pinyin="":this.$http.post(pinyin_api,e,function(e){this.$set("pinyin",e.pinyin)})},genPinyin:function(){this.touchPinyin()}}});